<div class="viewer-root">
  <h3>Preview del mandamiento</h3>

  <div class="controls">
    <button (click)="loadTemplate()" [disabled]="loading">Recargar plantilla</button>
    <button (click)="applySampleData()">Cargar datos de ejemplo</button>
    <button (click)="copyRenderedText()" [disabled]="!processedHtml">Copiar texto</button>
    <button (click)="copyRawHtml()" [disabled]="!processedHtml">Copiar HTML</button>
    <label>
      <input type="checkbox" [(ngModel)]="showRawTextarea" /> Mostrar HTML crudo
    </label>
  </div>

  <div *ngIf="loading" class="status">Cargando plantilla...</div>
  <div *ngIf="error" class="status error">{{ error }}</div>

  <!-- Formulario de datos -->
  <div class="form-container">
    <h4>Editar campos</h4>
    <div class="form-row" *ngFor="let key of objectKeys(formData)">
      <label>{{ key }}:</label>
      <input type="text" [(ngModel)]="formData[key]" (ngModelChange)="replacePlaceholders(formData)" />
    </div>
  </div>

  <!-- Preview del HTML procesado -->
  <div class="preview" [innerHTML]="processedHtmlSafe"></div>

  <!-- Textarea con el HTML crudo -->
  <div *ngIf="showRawTextarea" class="raw-container">
    <h4>HTML crudo (readonly)</h4>
    <textarea readonly rows="12" [value]="processedHtml"></textarea>
  </div>
</div>
